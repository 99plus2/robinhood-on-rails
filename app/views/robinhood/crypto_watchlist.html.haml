.list-dependencies{data: {behavior: "DashboardList"}}
.col-xs-12
  .quotes
    - @stock_lists.each do |list|
      %div{class: "list-#{list.id}"}
        - if list.name.present?
          %h4
            = list.name
            %small
              = link_to "x", delete_stock_list_path(id: list.id), remote: true, class: "hide-on-click", data: {target: ".list-#{list.id}"}

        %table.table.sortable-table{data: {id: list.id, sort_target: ".watchlist-item"}}
          %tr
            %th From
            %th To
            %th Price
            %th Today's change
            %th Buy
            %th Watchlist
          - list.instruments.each do |instrument|
            - quote = @crypto_quotes.find{|q| q["id"] == instrument.robinhood_id}
            - price = quote["mark_price"]
            - from_pair = $1.downcase if instrument["name"] =~ /^(.+) to /
            - to_pair = $1.downcase if instrument["name"] =~ / to (.+)$/
            %tr.watchlist-item.fundamentals-tooltip{class: "watchlist-hide-#{instrument.id}", data: { instrument_id: instrument.id}}
              %td= crypto_link(from_pair, {class: "symbol", data:{ html: true, placement: :right}})
              %td= to_pair =~ /us\s*dollar/i ? to_pair.titleize.pluralize : crypto_link(to_pair, {class: "symbol", data:{ html: true, placement: :right}})
              %td= price_display price
              %td.change{class: "text-" + up_down(quote["open_price"], price)}
                = change_display(quote["open_price"], price)
              %td= #render "robinhood/order_form_modal", symbol: instrument.symbol, side: @side, price: price, num_shares: (@investments.present? ? @investments[instrument.symbol]["quantity"] : nil)
              %td.remove-from-watchlist
                - if false
                  = form_tag remove_from_watchlist_path, remote: true do
                    = hidden_field_tag :symbol, instrument.symbol
                    = submit_tag "X", class: "btn btn-default hide-on-click", data: {target: ".watchlist-hide-#{instrument.id}"}

    = render "stock_list_form", group: "crypto_watchlist_#{@watchlist['name']}"
    %br
    %br
    %br
    %br